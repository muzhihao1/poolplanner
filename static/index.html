<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âè∞ÁêÉÊ°åËá™Âä®Â∏ÉÂ±ÄÁ≥ªÁªü v2.0</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .app-container {
            min-height: 100vh;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            color: #2d3748;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .header .subtitle {
            color: #718096;
            font-size: 16px;
        }
        
        .version-badge {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .control-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            height: fit-content;
            max-height: calc(100vh - 160px);
            overflow-y: auto;
        }
        
        .canvas-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: auto;
        }
        
        .canvas-wrapper {
            display: inline-block;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        canvas {
            border: 2px solid #e2e8f0;
            cursor: crosshair;
            display: block;
            background: #ffffff;
        }
        
        .mode-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 24px;
        }
        
        .mode-button {
            padding: 12px 8px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
        }
        
        .mode-button:hover {
            border-color: #cbd5e0;
            transform: translateY(-1px);
        }
        
        .mode-button.active {
            border-color: #4CAF50;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        .section {
            margin-bottom: 24px;
        }
        
        .section h3 {
            color: #2d3748;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .section-icon {
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }
        
        .input-group {
            margin-bottom: 16px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 6px;
            color: #4a5568;
            font-weight: 500;
            font-size: 14px;
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        .button {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .button:active {
            transform: translateY(0);
        }
        
        .button.primary {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }
        
        .button.secondary {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }
        
        .button.danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }
        
        .button:disabled {
            background: #e2e8f0;
            color: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .stats {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border: 1px solid #dee2e6;
        }
        
        .stats h3 {
            margin-bottom: 16px;
            color: #2d3748;
            font-size: 18px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .stat-label {
            color: #718096;
            font-size: 14px;
        }
        
        .stat-value {
            color: #2d3748;
            font-weight: 600;
            font-size: 14px;
        }
        
        .algorithm-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .algorithm-option {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .algorithm-option:hover {
            border-color: #cbd5e0;
        }
        
        .algorithm-option.active {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .algorithm-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 4px;
        }
        
        .algorithm-desc {
            font-size: 12px;
            color: #718096;
        }
        
        .obstacles-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 12px;
        }
        
        .obstacle-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f7fafc;
            margin-bottom: 6px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
        }
        
        .obstacle-info {
            font-size: 14px;
            color: #4a5568;
        }
        
        .remove-btn {
            padding: 4px 8px;
            background: #fed7d7;
            color: #c53030;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s ease;
        }
        
        .remove-btn:hover {
            background: #feb2b2;
        }
        
        .message {
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 16px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .message.success {
            background: #f0fff4;
            color: #22543d;
            border: 1px solid #9ae6b4;
        }
        
        .message.error {
            background: #fed7d7;
            color: #c53030;
            border: 1px solid #feb2b2;
        }
        
        .field-info {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            font-size: 14px;
            border: 1px solid #e2e8f0;
        }
        
        .field-info-item {
            margin-bottom: 4px;
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }
        
        .field-info-label {
            color: #718096;
        }
        
        .field-info-value {
            color: #2d3748;
            font-weight: 600;
        }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .preset-button {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .preset-button:hover {
            background: #f7fafc;
            border-color: #cbd5e0;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // APIÂü∫Á°ÄURL
        const API_BASE_URL = window.location.origin;
        
        // ÁªòÂà∂Ê®°Âºè
        const DrawMode = {
            BOUNDARY: 'boundary',
            OBSTACLE: 'obstacle',
            VIEW: 'view'
        };
        
        // È¢ÑËÆæÂú∫Âú∞
        const PRESET_FIELDS = [
            { name: 'Â∞èÂûã (8√ó12m)', width: 8000, height: 12000 },
            { name: '‰∏≠Âûã (10√ó15m)', width: 10000, height: 15000 },
            { name: 'Â§ßÂûã (15√ó20m)', width: 15000, height: 20000 },
            { name: 'Ë∂ÖÂ§ß (20√ó25m)', width: 20000, height: 25000 }
        ];
        
        function App() {
            // Áä∂ÊÄÅÁÆ°ÁêÜ
            const [drawMode, setDrawMode] = useState(DrawMode.VIEW);
            const [boundaryPoints, setBoundaryPoints] = useState([]);
            const [obstacles, setObstacles] = useState([]);
            const [tables, setTables] = useState([]);
            const [isOptimizing, setIsOptimizing] = useState(false);
            const [stats, setStats] = useState(null);
            const [error, setError] = useState(null);
            const [success, setSuccess] = useState(null);
            const [fieldArea, setFieldArea] = useState(0);
            
            // ÈÖçÁΩÆÂèÇÊï∞
            const [config, setConfig] = useState({
                wall_distance: 1500,
                table_distance: 1400,
                table_width: 2850,
                table_height: 1550,
                use_enhanced_algorithm: true
            });
            
            // CanvasÂºïÁî®
            const canvasRef = useRef(null);
            const scale = 0.05; // 50ÂÉèÁ¥† = 1Á±≥
            
            // ËÆ°ÁÆóÂú∫Âú∞Èù¢ÁßØ
            const calculateArea = (points) => {
                if (points.length < 3) return 0;
                let area = 0;
                for (let i = 0; i < points.length; i++) {
                    const j = (i + 1) % points.length;
                    area += points[i][0] * points[j][1];
                    area -= points[j][0] * points[i][1];
                }
                return Math.abs(area) / 2 / 1000000; // ËΩ¨Êç¢‰∏∫Âπ≥ÊñπÁ±≥
            };
            
            // Êõ¥Êñ∞Âú∫Âú∞Èù¢ÁßØ
            useEffect(() => {
                if (boundaryPoints.length >= 3) {
                    setFieldArea(calculateArea(boundaryPoints));
                }
            }, [boundaryPoints]);
            
            // ËÆæÁΩÆÈ¢ÑËÆæÂú∫Âú∞
            const setPresetField = (preset) => {
                const boundary = [
                    [0, 0],
                    [preset.width, 0],
                    [preset.width, preset.height],
                    [0, preset.height]
                ];
                setBoundaryPoints(boundary);
                setObstacles([]);
                setTables([]);
                setStats(null);
            };
            
            // Â§ÑÁêÜÈº†Ê†áÁÇπÂáª
            const handleCanvasClick = (e) => {
                const canvas = canvasRef.current;
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX - rect.left) / scale;
                const y = (e.clientY - rect.top) / scale;
                
                if (drawMode === DrawMode.BOUNDARY) {
                    setBoundaryPoints([...boundaryPoints, [x, y]]);
                } else if (drawMode === DrawMode.OBSTACLE) {
                    setObstacles([...obstacles, {
                        type: 'rectangle',
                        center: [x, y],
                        size: [400, 400]
                    }]);
                }
            };
            
            // ÁªòÂà∂ÂáΩÊï∞
            const draw = () => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // ÁªòÂà∂ÁΩëÊ†º
                ctx.strokeStyle = '#f0f0f0';
                ctx.lineWidth = 1;
                const gridSize = 1000 * scale; // 1Á±≥ÁΩëÊ†º
                
                for (let x = 0; x <= canvas.width; x += gridSize) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, canvas.height);
                    ctx.stroke();
                }
                for (let y = 0; y <= canvas.height; y += gridSize) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
                
                // ÁªòÂà∂ËæπÁïå
                if (boundaryPoints.length > 2) {
                    ctx.fillStyle = 'rgba(200, 200, 200, 0.3)';
                    ctx.strokeStyle = '#333';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(boundaryPoints[0][0] * scale, boundaryPoints[0][1] * scale);
                    for (let i = 1; i < boundaryPoints.length; i++) {
                        ctx.lineTo(boundaryPoints[i][0] * scale, boundaryPoints[i][1] * scale);
                    }
                    ctx.closePath();
                    ctx.fill();
                    ctx.stroke();
                } else if (boundaryPoints.length > 0) {
                    // ÁªòÂà∂ËæπÁïåÁÇπ
                    ctx.fillStyle = '#333';
                    boundaryPoints.forEach(point => {
                        ctx.beginPath();
                        ctx.arc(point[0] * scale, point[1] * scale, 5, 0, 2 * Math.PI);
                        ctx.fill();
                    });
                }
                
                // ÁªòÂà∂ÈöúÁ¢çÁâ©
                ctx.fillStyle = '#666';
                obstacles.forEach((obstacle, index) => {
                    if (obstacle.type === 'rectangle') {
                        const [x, y] = obstacle.center;
                        const [width, height] = obstacle.size;
                        ctx.fillRect(
                            (x - width/2) * scale, 
                            (y - height/2) * scale, 
                            width * scale, 
                            height * scale
                        );
                    }
                });
                
                // ÁªòÂà∂Âè∞ÁêÉÊ°å
                tables.forEach((table, index) => {
                    ctx.save();
                    
                    const centerX = table.x + table.width / 2;
                    const centerY = table.y + table.height / 2;
                    
                    ctx.translate(centerX * scale, centerY * scale);
                    
                    if (table.rotation === 90) {
                        ctx.rotate(Math.PI / 2);
                    }
                    
                    // Âè∞ÁêÉÊ°å‰∏ª‰Ωì
                    ctx.fillStyle = '#4CAF50';
                    ctx.fillRect(
                        -table.width * scale / 2, 
                        -table.height * scale / 2, 
                        table.width * scale, 
                        table.height * scale
                    );
                    
                    // Âè∞ÁêÉÊ°åËæπÊ°Ü
                    ctx.strokeStyle = '#2E7D32';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(
                        -table.width * scale / 2, 
                        -table.height * scale / 2, 
                        table.width * scale, 
                        table.height * scale
                    );
                    
                    // Âè∞ÁêÉÊ°åÁºñÂè∑
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(index + 1, 0, 0);
                    
                    ctx.restore();
                });
            };
            
            // ‰ºòÂåñÂ∏ÉÂ±Ä
            const handleOptimize = async () => {
                if (boundaryPoints.length < 3) {
                    setError('ËØ∑ÂÖàÁªòÂà∂Âú∫Âú∞ËæπÁïå');
                    return;
                }
                
                setIsOptimizing(true);
                setError(null);
                setSuccess(null);
                
                try {
                    const response = await fetch(`${API_BASE_URL}/api/layout/optimize`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            boundary: boundaryPoints,
                            obstacles: obstacles,
                            config: config
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error('‰ºòÂåñËØ∑Ê±ÇÂ§±Ë¥•');
                    }
                    
                    const data = await response.json();
                    
                    if (data.success && data.tables) {
                        setTables(data.tables);
                        setStats(data.stats);
                        
                        const algorithmName = config.use_enhanced_algorithm ? 'Â¢ûÂº∫ÁÆóÊ≥ï' : '‰º†ÁªüÁÆóÊ≥ï';
                        setSuccess(`${algorithmName}ÊàêÂäüÂ∏ÉÁΩÆ ${data.count} ‰∏™Âè∞ÁêÉÊ°å`);
                    } else {
                        throw new Error(data.error || '‰ºòÂåñÂ§±Ë¥•');
                    }
                } catch (err) {
                    setError(err.message);
                } finally {
                    setIsOptimizing(false);
                }
            };
            
            // Ê∏ÖÈô§Êìç‰Ωú
            const clearBoundary = () => {
                setBoundaryPoints([]);
                setTables([]);
                setStats(null);
                setFieldArea(0);
            };
            
            const clearObstacles = () => {
                setObstacles([]);
                setTables([]);
                setStats(null);
            };
            
            const removeObstacle = (index) => {
                const newObstacles = [...obstacles];
                newObstacles.splice(index, 1);
                setObstacles(newObstacles);
            };
            
            // Êõ¥Êñ∞ÈÖçÁΩÆ
            const updateConfig = (key, value) => {
                setConfig({
                    ...config,
                    [key]: value
                });
            };
            
            // ÈáçÁªò
            useEffect(() => {
                draw();
            }, [boundaryPoints, obstacles, tables]);
            
            // ËÆæÁΩÆcanvasÂ∞∫ÂØ∏
            useEffect(() => {
                const canvas = canvasRef.current;
                if (canvas) {
                    canvas.width = 800;
                    canvas.height = 600;
                    draw();
                }
            }, []);
            
            return (
                <div className="app-container">
                    <div className="header">
                        <div>
                            <h1>üé± Âè∞ÁêÉÊ°åËá™Âä®Â∏ÉÂ±ÄÁ≥ªÁªü</h1>
                            <p className="subtitle">Êô∫ËÉΩ‰ºòÂåñÂè∞ÁêÉÂéÖÂ∏ÉÂ±ÄÔºåÊúÄÂ§ßÂåñÁ©∫Èó¥Âà©Áî®Áéá</p>
                        </div>
                        <div className="version-badge">
                            v2.0 Â¢ûÂº∫Áâà
                        </div>
                    </div>
                    
                    <div className="main-content">
                        <div className="control-panel">
                            {/* ÁªòÂà∂Ê®°Âºè */}
                            <div className="section">
                                <h3>
                                    <span className="section-icon">‚úèÔ∏è</span>
                                    ÁªòÂà∂Ê®°Âºè
                                </h3>
                                <div className="mode-buttons">
                                    <button
                                        className={`mode-button ${drawMode === DrawMode.VIEW ? 'active' : ''}`}
                                        onClick={() => setDrawMode(DrawMode.VIEW)}
                                    >
                                        Êü•Áúã
                                    </button>
                                    <button
                                        className={`mode-button ${drawMode === DrawMode.BOUNDARY ? 'active' : ''}`}
                                        onClick={() => setDrawMode(DrawMode.BOUNDARY)}
                                    >
                                        ËæπÁïå
                                    </button>
                                    <button
                                        className={`mode-button ${drawMode === DrawMode.OBSTACLE ? 'active' : ''}`}
                                        onClick={() => setDrawMode(DrawMode.OBSTACLE)}
                                    >
                                        ÈöúÁ¢ç
                                    </button>
                                </div>
                            </div>
                            
                            {/* È¢ÑËÆæÂú∫Âú∞ */}
                            <div className="section">
                                <h3>
                                    <span className="section-icon">üè¢</span>
                                    Âø´ÈÄüÂú∫Âú∞
                                </h3>
                                <div className="preset-buttons">
                                    {PRESET_FIELDS.map((preset, index) => (
                                        <button
                                            key={index}
                                            className="preset-button"
                                            onClick={() => setPresetField(preset)}
                                        >
                                            {preset.name}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            
                            {/* ÁÆóÊ≥ïÈÄâÊã© */}
                            <div className="section">
                                <h3>
                                    <span className="section-icon">üß†</span>
                                    ÁÆóÊ≥ïÈÄâÊã©
                                </h3>
                                <div className="algorithm-selector">
                                    <div 
                                        className={`algorithm-option ${config.use_enhanced_algorithm ? 'active' : ''}`}
                                        onClick={() => updateConfig('use_enhanced_algorithm', true)}
                                    >
                                        <div className="algorithm-title">Â¢ûÂº∫ÁÆóÊ≥ï</div>
                                        <div className="algorithm-desc">Êô∫ËÉΩÁΩëÊ†º+Á©∫ÈöôÂ°´ÂÖÖ</div>
                                    </div>
                                    <div 
                                        className={`algorithm-option ${!config.use_enhanced_algorithm ? 'active' : ''}`}
                                        onClick={() => updateConfig('use_enhanced_algorithm', false)}
                                    >
                                        <div className="algorithm-title">‰º†ÁªüÁÆóÊ≥ï</div>
                                        <div className="algorithm-desc">Â§öÁ≠ñÁï•ÁªÑÂêà</div>
                                    </div>
                                </div>
                            </div>
                            
                            {/* ÈÖçÁΩÆÂèÇÊï∞ */}
                            <div className="section">
                                <h3>
                                    <span className="section-icon">‚öôÔ∏è</span>
                                    ÈÖçÁΩÆÂèÇÊï∞
                                </h3>
                                <div className="input-group">
                                    <label>Â¢ôÂ£ÅÂÆâÂÖ®Ë∑ùÁ¶ª (mm)</label>
                                    <input
                                        type="number"
                                        value={config.wall_distance}
                                        onChange={(e) => updateConfig('wall_distance', parseInt(e.target.value))}
                                    />
                                </div>
                                
                                <div className="input-group">
                                    <label>Âè∞ÁêÉÊ°åÈó¥Ë∑ù (mm)</label>
                                    <input
                                        type="number"
                                        value={config.table_distance}
                                        onChange={(e) => updateConfig('table_distance', parseInt(e.target.value))}
                                    />
                                </div>
                            </div>
                            
                            {/* Êìç‰ΩúÊåâÈíÆ */}
                            <div className="section">
                                <h3>
                                    <span className="section-icon">üöÄ</span>
                                    Êìç‰Ωú
                                </h3>
                                <button 
                                    className="button primary"
                                    onClick={handleOptimize}
                                    disabled={isOptimizing || boundaryPoints.length < 3}
                                >
                                    {isOptimizing && <span className="loading-spinner"></span>}
                                    {isOptimizing ? '‰ºòÂåñ‰∏≠...' : 'üéØ ‰ºòÂåñÂ∏ÉÂ±Ä'}
                                </button>
                                
                                <button 
                                    className="button secondary"
                                    onClick={clearBoundary}
                                >
                                    üóëÔ∏è Ê∏ÖÈô§ËæπÁïå
                                </button>
                                
                                <button 
                                    className="button danger"
                                    onClick={clearObstacles}
                                >
                                    üö´ Ê∏ÖÈô§ÈöúÁ¢çÁâ©
                                </button>
                            </div>
                            
                            {/* ÈöúÁ¢çÁâ©ÂàóË°® */}
                            {obstacles.length > 0 && (
                                <div className="section">
                                    <h3>
                                        <span className="section-icon">üöß</span>
                                        ÈöúÁ¢çÁâ©ÂàóË°®
                                    </h3>
                                    <div className="obstacles-list">
                                        {obstacles.map((obstacle, index) => (
                                            <div key={index} className="obstacle-item">
                                                <span className="obstacle-info">
                                                    ÈöúÁ¢çÁâ© {index + 1}
                                                </span>
                                                <button 
                                                    className="remove-btn"
                                                    onClick={() => removeObstacle(index)}
                                                >
                                                    Âà†Èô§
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                            
                            {/* ÁªüËÆ°‰ø°ÊÅØ */}
                            {stats && (
                                <div className="stats">
                                    <h3>üìä Â∏ÉÂ±ÄÁªüËÆ°</h3>
                                    <div className="stats-grid">
                                        <div className="stat-item">
                                            <span className="stat-label">Âè∞ÁêÉÊ°åÊï∞Èáè</span>
                                            <span className="stat-value">{stats.table_count} ‰∏™</span>
                                        </div>
                                        <div className="stat-item">
                                            <span className="stat-label">Âú∫Âú∞Èù¢ÁßØ</span>
                                            <span className="stat-value">{stats.total_area} m¬≤</span>
                                        </div>
                                        <div className="stat-item">
                                            <span className="stat-label">Á©∫Èó¥Âà©Áî®Áéá</span>
                                            <span className="stat-value">{stats.space_utilization}%</span>
                                        </div>
                                        <div className="stat-item">
                                            <span className="stat-label">Âπ≥ÂùáÈó¥Ë∑ù</span>
                                            <span className="stat-value">{stats.average_distance} mm</span>
                                        </div>
                                        {stats.algorithm_used && (
                                            <div className="stat-item">
                                                <span className="stat-label">‰ΩøÁî®ÁÆóÊ≥ï</span>
                                                <span className="stat-value">{stats.algorithm_used}</span>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}
                            
                            {/* ÊèêÁ§∫‰ø°ÊÅØ */}
                            {error && (
                                <div className="message error">
                                    ‚ùå {error}
                                </div>
                            )}
                            {success && (
                                <div className="message success">
                                    ‚úÖ {success}
                                </div>
                            )}
                        </div>
                        
                        <div className="canvas-container">
                            <div className="canvas-wrapper">
                                <canvas 
                                    ref={canvasRef}
                                    onClick={handleCanvasClick}
                                />
                                {fieldArea > 0 && (
                                    <div className="field-info">
                                        <div className="field-info-item">
                                            <span className="field-info-label">Âú∫Âú∞Èù¢ÁßØ:</span>
                                            <span className="field-info-value">{fieldArea.toFixed(1)} m¬≤</span>
                                        </div>
                                        {tables.length > 0 && (
                                            <div className="field-info-item">
                                                <span className="field-info-label">Âè∞ÁêÉÊ°å:</span>
                                                <span className="field-info-value">{tables.length} ‰∏™</span>
                                            </div>
                                        )}
                                        {stats && (
                                            <div className="field-info-item">
                                                <span className="field-info-label">Âà©Áî®Áéá:</span>
                                                <span className="field-info-value">{stats.space_utilization}%</span>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Ê∏≤ÊüìÂ∫îÁî®
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>